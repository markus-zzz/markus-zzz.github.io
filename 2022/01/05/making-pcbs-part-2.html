<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Making some PCBs - part 2 (HyperRAM) | ZZZ-Consulting</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Making some PCBs - part 2 (HyperRAM)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Stage 1 - HyperRAM 2-layer board." />
<meta property="og:description" content="Stage 1 - HyperRAM 2-layer board." />
<link rel="canonical" href="https://www.zzzconsulting.se/2022/01/05/making-pcbs-part-2.html" />
<meta property="og:url" content="https://www.zzzconsulting.se/2022/01/05/making-pcbs-part-2.html" />
<meta property="og:site_name" content="ZZZ-Consulting" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-05T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Making some PCBs - part 2 (HyperRAM)" />
<script type="application/ld+json">
{"@type":"BlogPosting","datePublished":"2022-01-05T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.zzzconsulting.se/2022/01/05/making-pcbs-part-2.html"},"headline":"Making some PCBs - part 2 (HyperRAM)","url":"https://www.zzzconsulting.se/2022/01/05/making-pcbs-part-2.html","description":"Stage 1 - HyperRAM 2-layer board.","dateModified":"2022-01-05T00:00:00+01:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://www.zzzconsulting.se/feed.xml" title="ZZZ-Consulting" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-122494618-1', 'auto');
  ga('send', 'pageview');
}
</script>
  
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">ZZZ-Consulting</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About me</a><a class="page-link" href="/links/">Links</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Making some PCBs - part 2 (HyperRAM)</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2022-01-05T00:00:00+01:00" itemprop="datePublished">Jan 5, 2022
      </time></p>
  </header>

  
    <script type="text/javascript" async
		  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


  

  
    <script type="text/javascript" async
		  src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/7.1.2/mermaid.min.js">
</script>

  

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="stage-1---hyperram">Stage 1 - HyperRAM</h1>
<p>2-layer board.</p>

<p>First out is a HyperRAM expansion board for the ULX3S. It makes sense to see
early if I will be able to pull off BGA assembly with the equipment I have.
Also I happen to have 10 of these
<a href="https://www.mouser.se/ProductDetail/cypress-semiconductor/s27kl0641dabhi020/">S27KL0641DABHI020</a>
laying around.</p>

<p>5x5 BGA means that the two outermost rings can be routed in the same layer
(only one ball remaining in the middle but that can also escape in the same
layer as one corner is missing a ball).</p>

<p>I finally had a go at this and put together quick and dirty PCB in KiCAD and
had <a href="https://aisler.net/">https://aisler.net/</a> manufacture it for me. By quick and dirty I mean that
the layout is ugly and the traces are not length matched so I would not expect
to get any performance out of it. The board should be functionally correct
though. I did not bother to put the KiCad files on GitHub.</p>

<p>Two different soldering methods were evaluated and I tried capturing the chip
profile with a cheap cell-phone camera through a binocular microscope.</p>

<p>On the left only tacky flux was applied and then using hot air from above
(station set to 300C at 50l/min) the chip was soldered in place. After a while
the chip noticeably sunk into place and I tried to nudge it several times with
a pair of tweezers after which it immediately bounced back. This was a quick
method but the end result is that the chip sits flush with the board and visual
inspection is not really possible.</p>

<p>On the right no flux was used but instead solder paste was applied through a
stencil. The board was placed on a hot-plate that slowly rose to a temperature
set to 220C after which hot air was applied from above (with station set to
300C at 40l/min). It was not as noticeable when the chip sunk into place and I
did not dare to nudge it (as it was still on the hot-plate). The end result
looks much nicer though with the solder balls clearly visible and one can
clearly see that there is no bridging.</p>

<p><img src="/download/pcb/hyperram-bga-pcb.jpg" alt="HyperRAM BGA" /></p>

<p>Eventually I will try to verify the boards with one of the controllers from the
list below and report the results.</p>

<ul>
  <li><a href="https://github.com/blackmesalabs/hyperram">https://github.com/blackmesalabs/hyperram</a> - slow but portable controller</li>
  <li><a href="https://github.com/gregdavill/litex-hyperram">https://github.com/gregdavill/litex-hyperram</a> - full performance controller for ECP5 in Migen</li>
  <li><a href="https://1bitsquared.com/products/pmod-hyperram">https://1bitsquared.com/products/pmod-hyperram</a></li>
  <li><a href="https://www.youtube.com/watch?v=dThZDl-QG5s">https://www.youtube.com/watch?v=dThZDl-QG5s</a></li>
</ul>

<p>I did a second try run using the stencil after having acquired
<a href="https://www.oshstencils.com/">https://www.oshstencils.com/</a> excellent PCB fixture jig. To me having the
board properly held in place by jig helped a lot when applying the paste. Of
course one can get a similar effect using a few scrap PCBs but I don’t really
have many of those lying around that are the right size and besides these
brackets just cost a few dollars.</p>

<p>As far as I can tell the stencil alignment and paste coverage turned out well
and the end result looks good. So with this I feel reasonably confident that I
will also be able to handle the larger FPGA BGA with its 0.8mm pitch (the
HyperRAM BGA has a 1.0mm pitch). Again I still have not gotten around to
actually verify that these modules work so maybe I should not say too much.</p>

<p><img src="/download/pcb/hyperram-bga-pcb-2.jpg" alt="HyperRAM BGA second attempt" /></p>

<h2 id="verification">Verification</h2>

<p>Now a few monhts later I felt sufficiently energized to have a go at testing
the HyperRAM boards.  I set up <a href="https://github.com/markus-zzz/hyperram-test">a test
bench</a> using <a href="https://github.com/blackmesalabs/hyperram">the portable
HyperRAM controller from
blackmesalabs</a> and the
<a href="https://github.com/YosysHQ/picorv32">PicoRV32</a> RISC-V CPU core.</p>

<p>The DRAM is mapped into the CPU’s address space presenting its 8MB as 2M 32-bit
dwords.</p>

<p>The test consists of having the CPU write the Fibonacci sequence, as 32-bit
integers, to memory and then verifying that it reads back correctly. Test
result is presented by lighting the appropriate LEDs.</p>

<p>All three boards have been fully assembled and the test passes on all three.</p>

<p>It should be noted that this is a basic test running the memory at a low
frequency (6.25MHz) so it does not stress test the board in any way. It does
however provide some confidence in that the part survived the assembly process,
the solder joints are reasonably sound and that there is no bridging.</p>

<p><img src="/download/pcb/hyperram-test-pcb.jpg" alt="Testing the HyperRAM board" /></p>

<h2 id="future">Future</h2>

<p>It could be interesting to improve the controller, setting a shorter latency,
or simply switch to using a different one.</p>

  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://www.zzzconsulting.se/2022/01/05/making-pcbs-part-2.html';
      this.page.identifier = 'https://www.zzzconsulting.se/2022/01/05/making-pcbs-part-2.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://www-zzzconsulting-se.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2022/01/05/making-pcbs-part-2.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">ZZZ-Consulting</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">ZZZ-Consulting</li><li><a class="u-email" href="mailto:firstname.lastname@gmail.com">firstname.lastname@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/markus-zzz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">markus-zzz</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Me writing blog posts about various topics I find interesting. Turns out these are mostly FPGA and retro-computing related.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
